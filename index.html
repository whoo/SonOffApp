<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
	<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
</head>
<body>


	<div data-role="page" id="main">
		<div data-role="header"  data-theme="b">
			<h1>Esp config</h1>
		</div>
		<div role="main" >
			<div class="ui-bar ui-bar-b">
				<div class="ui-field-contain">
					<input type="text" name="text-1" id="login" value="Sonoff" placeholder="Sonoff">
					<select name="select-native-1" id="wifi">
						<option value="HomeDD">HomeDD</option>
						<option value="test">test</option>
					</select>
					<input type="password" data-clear-btn="true" name="password-2" id="password-2" value="" autocomplete="off">
				</div>
			</div>

			<hr>
			<div data-role="collapsible" data-collapsed-icon="carat-d" data-expanded-icon="carat-u">
				<h4>MQTT info</h4>
				<input type="text" name="text-1" value="192.168.2.30" placeholder="192.168.2.30">
				<input type="text" name="text-1" value="1883" placeholder="1883">
				<input type="text" name="text-1" value="none" placeholder="none">
				<input type="text" name="text-1" value="none" placeholder="none">
			</div>
			<hr>
			<button id="go" class="ui-btn ui-shadow ui-corner-all ui-btn-icon-right ui-icon-check">Go Men</button>
		</div>

	</div>

	<script>
	var wifi;


	$(function() {
		$.ajax({url:"http://wizz/mqtt/wifi"}).done(function(data) {

			wifi=data.split("\n");
			wifi.forEach(function(i,index) {
				$("#wifi").append($('<option>', {
					value:i,
					text:i
				}))
			});
		});


		$("#go").click(function(e){
			option={
				ssid:$("select").val(),
				hostname:$("input")[0].value,
				password:$("input")[1].value,
				broker:$("input")[2].value,
				port:$("input")[3].value,
				user:$("input")[4].value,
				pass:$("input")[5].value,

			};

			$.get("/push", option);

		})
	});

	</script>

	</body>
	</html>
